10 SCREEN 2: COLOR 15,1,1: CLS
20 DIM X(100), Y(100)
30 L=5: DX=1: DY=0
40 FOR I=1 TO L: X(I)=10-I: Y(I)=10: NEXT I
50 GOSUB 950 ' Desenha bordas uma vez
60 GOSUB 600 ' Gera comida
70 GOSUB 920 ' Pontuação inicial

80 T$=INKEY$: IF T$<>"" THEN GOSUB 700
90 GOSUB 800 ' Move a cobra
100 FOR D=1 TO 20: NEXT D
110 GOTO 80

800 XN = X(1) + DX: YN = Y(1) + DY

810 IF XN<1 OR XN>30 OR YN<1 OR YN>22 THEN GOSUB 990: RETURN

820 FOR I=1 TO L
830 IF X(I)=XN AND Y(I)=YN THEN GOSUB 990: RETURN
840 NEXT I

850 PSET(X(L)*8,Y(L)*8),1

860 FOR I=L TO 2 STEP -1
870 X(I) = X(I-1): Y(I) = Y(I-1)
880 NEXT I

890 X(1) = XN: Y(1) = YN

891 IF XN=CX AND YN=CY THEN GOSUB 898

892 PSET(X(1)*8,Y(1)*8),14
893 RETURN

898 L = L + 1
899 X(L) = X(L-1): Y(L) = Y(L-1)
900 GOSUB 600 ' SÓ aqui geramos nova comida
901 GOSUB 920: RETURN

910 PSET(X(1)*8,Y(1)*8),14
915 RETURN

700 IF T$=CHR$(30) AND DY=0 THEN DX=0: DY=-1 ' Cima
710 IF T$=CHR$(31) AND DY=0 THEN DX=0: DY=1  ' Baixo
720 IF T$=CHR$(29) AND DX=0 THEN DX=-1: DY=0 ' Esquerda
730 IF T$=CHR$(28) AND DX=0 THEN DX=1: DY=0  ' Direita
740 RETURN

600 CX = INT(RND(1)*30)+1
610 CY = INT(RND(1)*22)+1
620 PSET(CX*8, CY*8),10
630 RETURN

920 LOCATE 28,0: PRINT "PTS:";L-5;
930 RETURN

950 LINE (0,0)-(255,0),12
951 LINE (0,0)-(0,191),12
952 LINE (255,0)-(255,191),12
953 LINE (0,191)-(255,191),12
954 RETURN

990 CLS
991 PRINT "FIM DE JOGO!"
992 PRINT "PONTOS: ";L-5
993 END
